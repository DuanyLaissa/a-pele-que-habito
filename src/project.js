require=function a(i,s,r){function u(t,e){if(!s[t]){if(!i[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(h)return h(t,!0);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}var o=s[t]={exports:{}};i[t][0].call(o.exports,function(e){return u(i[t][1][e]||e)},o,o.exports,a,i,s,r)}return s[t].exports}for(var h="function"==typeof require&&require,e=0;e<r.length;e++)u(r[e]);return u}({GameMenuController:[function(e,t,n){"use strict";cc._RF.push(t,"820c8qvs8hFMIIeJ5/0GOsN","GameMenuController");cc.Class({extends:cc.Component,properties:{gameScene:{default:"gameScene"},gameLevels:{default:[],url:[cc.RawAsset]},button:cc.Prefab,mainLayout:cc.Node,layoutPrefab:cc.Prefab},onLoad:function(){cc.director.resume(),this.isLevelReady=!1,this.setLevel()},setLevel:function(){var e=cc.instantiate(this.layoutPrefab);e.parent=this.mainLayout,this.setupButtons(this.gameLevels,e,"chooseLevel")},setupButtons:function(e,t,n){for(var c=0;c<e.length;c++)this.createButton(c,e,t,n)},createButton:function(e,t,n,c){var o=cc.instantiate(this.button);o.parent=n.getChildByName("view").getChildByName("content"),o.active=!0;var a=new cc.Component.EventHandler;a.target=this.node,a.component="GameMenuController",a.handler=c,o.index=e;var i=o.getChildByName("Label");i=i.getComponent(cc.Label);var s=t[e].split("/");return s=s[s.length-1].split(".")[0],i.string=s,o.getComponent(cc.Button).clickEvents.push(a),o},chooseLevel:function(e){var t=e.target.index;this.dependentSkins&&this.testSkin[t]&&this.chooseSkin(e),this.gameLevels[t]&&cc.loader.load(this.gameLevels[t],function(e,t){cc.log(t),this.loadGameData(t,function(e){this.addLevel(t.data,e)}.bind(this))}.bind(this))},loadGameData:function(e,c){var t=this,o={},a=0,i=!0;if(e.hasOwnProperty("assets")){var n=function(n){e.assets.hasOwnProperty(n)&&(r=e.assets[n],a++,r.type||(r.type="cc.SpriteFrame"),t.loadAsset(r.url,t.getTypeFunction(r.type),function(e,t){e||(o[n]=t),0!=--a||i||c(o)}))};for(var s in e.assets){var r;n(s)}}i=!1,0!=a||i||c(o)},loadAsset:function(e,t,n){cc.loader.loadRes(e,t,function(e,t){e&&cc.log("GameMenuController: Error loading file."+e),cc.log("asset loaded :"+t),n(e,t)})},addLevel:function(e,t){this.createGame();var n={};n.data=e,n.assets=t,window.game.level=n,this.loadGameScene()},getTypeFunction:function(e){switch(e){case"cc.Texture2D":return cc.Texture2D;case"cc.Font":return cc.Font;case"cc.SpriteAtlas":return cc.SpriteAtlas;case"cc.AudioClip":return cc.AudioClip;default:case"cc.SpriteFrame":return cc.SpriteFrame}return null},createGame:function(){window.hasOwnProperty("game")||(window.game={})},loadGameScene:function(){window.game.sceneID=0,cc.director.loadScene(this.gameScene)}});cc._RF.pop()},{}],SceneManager:[function(e,t,n){"use strict";cc._RF.push(t,"8cdfe/sxvdBr5K7ySpSCesQ","SceneManager"),cc.Class({extends:cc.Component,properties:{background:cc.Sprite,foreground:cc.Sprite,label:cc.Label,popup:cc.Node,choices:cc.Node,choiceButton:cc.Prefab},onLoad:function(){this.textID=0,this.step=window.game.level.data.steps[window.game.sceneID],this.assets=window.game.level.assets,this.background.spriteFrame=this.assets[this.step.background],this.updateScene(),this.createChoices()},nextText:function(){this.textID++,this.textID>=this.step.text.length?this.step.choices.length<1?this.endStory():this.showChoicePopup():this.updateScene()},updateScene:function(){this.foreground.spriteFrame=this.assets[this.step.foreground[this.textID]],this.label.string=this.step.text[this.textID]},createChoices:function(){for(var e=0;e<this.step.choices.length;e++){var t=cc.instantiate(this.choiceButton);t.parent=this.choices,t.active=!0,t.index=this.step.choices[e].target;var n=new cc.Component.EventHandler;n.target=this.node,n.component="SceneManager",n.customEventData=t.index,n.handler="makeChoice";var c=t.getChildByName("Label");(c=c.getComponent(cc.Label)).string=this.step.choices[e].text,t.getComponent(cc.Button).clickEvents.push(n)}},showChoicePopup:function(){this.popup.active=!0},closeChoicePopup:function(){this.popup.active=!1},endStory:function(){window.game.sceneID=0,cc.director.loadScene("GameMenu")},makeChoice:function(e){window.game.sceneID=e.target.index,cc.director.loadScene("GameScene")}}),cc._RF.pop()},{}]},{},["GameMenuController","SceneManager"]);